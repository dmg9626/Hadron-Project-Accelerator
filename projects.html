<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Project Page</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript">
        function getUserName()
        {
          var URL = "http://localhost:8080/getUsersName";
          var name = document.getElementById("loggedInUser");
          $.ajax({
            type: "POST",
            url: URL,
            dataType: "html",
            success: function(msg) {
              var json = JSON.parse(msg);
              name.innerHTML = "You are logged in as " + json.FirstName;
            },
            error: function (xhr, ajaxOptions, thrownError) {
              //alert("Error fetching " + URL);
            }
          });
        }
			
			function getUser(userID) {
				var URL = "http://localhost:8080/getUser?userID=" + userID;
				var user = undefined;
				$.ajax({
					type: "GET",
					url: URL,
					dataType: "html",
					success: function(msg) {
						user = msg;
					}
				});
				return user;
			}

        function getProjectData()
        {
        	var URL = "http://localhost:8080/getProject";
        	var div = document.getElementById("projectData");
			var data = {
				ProjectID: 1
			};

        	$.ajax({
        		type: "POST",
        		url: URL,
        		dataType: "html",
				data: data,
        		success: function(msg) {
        			var json = JSON.parse(msg)[0];
        			var response = "";
					var user = getUser(json.UserID);
        			response += "<h2>" + json.Title + "</h2>\n";
        			response += "<img src='" + json.ImageURL;
        			response += "' style='width:150px;height:150px;'>\n";
        			//response += "<h3>" + user.FirstName + " " + user.LastName + "</h3>\n";
        			//response += "<h5><a href='mailto:" + user.Email;
        			//response += "'>" + user.Email + "</a></h5>\n";
        			response += "<h3>" + json.University + "</h3>\n";
        			response += "<h4>" + json.Description + "</h5>\n";
        			response += "<h5>" + getMajor(json.MajorID) + "</h5>\n";
        			response += "<h5>" + getYear(json.AcademicStatusID) + "</h5>\n";
        			response += "<h5>" + getTimeline(json.TimelineID) + "</h5>\n";
        			div.innerHTML = response;
        		},
        		error: function (xhr, ajaxOptions, thrownError) {
        			alert("Error fetching " + URL + ": " + thrownError);
        		}
        	});
        }

			function getTimeline(timelineId) {
				timeline = "<h5>Timeline not specified</h5>";
				switch(parseInt(timelineId)) {
					case 0:
						timeline = "<h5>1-2 weeks</h5>";
						break;
					case 1:
						timeline = "<h5>3 weeks - 1 month</h5>";
						break;
					case 2:
						timeline = "<h5>1-2 months</h5>";
						break;
					case 3:
						timeline = "<h5>2-6 months</h5>";
						break;
					case 4:
						timeline = "<h5>6 months - 1 year</h5>";
						break;
					case 5:
						timeline = "<h5>1-2 years</h5>";
						break;
					case 6:
						timeline = "<h5>2 years +</h5>";
						break;
				}
				return timeline;
			}

        function getYear(academicStatusId) {
        	year = "<h4>Academic status not listed</h4>";
        	switch(parseInt(academicStatusId)) {
        		case 0:
          			year = "Freshman";
          			break;
        		case 1:
          			year = "Sophomore";
          			break;
       			case 2:
          			year = "Pre-Junior";
          			break;
        		case 3:
          			year = "Junior";
       				break;
        		case 4:
          			year = "Senior";
          			break;
      		}
      		return year;
		}

    	function getMajor(majorId) {
      		major = "<h4>College not listed</h4>";
      		switch(parseInt(majorId)) {
        		case 0:
          			major = "<h4>Lebow College of Business</h4>";
          			break;
        		case 1:
        			major = "<h4>College of Computing and Informatics</h4>";
          			break;
        		case 2:
          			major = "<h4>College of Engineering</h4>";
          			break;
        		case 3:
          			major = "<h4>Westphal College of Media Arts & Design</h4>";
          			break;
        		case 4:
          			major = "<h4>College of Nursing and Health Professions</h4>";
          			break;
      		}
      		return major;
    	}

    </script>
    <style>
      /* Remove the navbar's default margin-bottom and rounded borders */
      .navbar {
        margin-bottom: 0;
        border-radius: 0;
      }

      /* Set height of the grid so .sidenav can be 100% (adjust as needed) */
      .row.content {height: 450px}

      /* Set gray background color and 100% height */
      .sidenav {
        padding-top: 20px;
        background-color: #f1f1f1;
        height: 100%;
      }

      /* Set black background color, white text and some padding */
      footer {
        background-color: #555;
        color: white;
        padding: 15px;
      }

      img {
        border-radius: 5px 5px 5px 5px;
      }

      /* On small screens, set height to 'auto' for sidenav and grid */
      @media screen and (max-width: 767px) {
        .sidenav {
          height: auto;
          padding: 15px;
        }
        .row.content {height:auto;}
      }
    </style>
  </head>
  <body onload="getUserName(); getProjectData()">
  <nav class="navbar navbar-inverse">
    <div class="container-fluid">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/home.html">HPA</a>
      </div>
      <div class="collapse navbar-collapse" id="myNavbar">
        <ul class="nav navbar-nav">
          <li><a href="/user.html">User</a></li>
          <li class="active"><a href="/projects.html">Projects</a></li>
        </ul>
        <ul class="nav navbar-nav navbar-right">
          <li><a href="/login.html"><span class="glyphicon glyphicon-log-in"></span> Login</a></li>
        </ul>
      </div>
    </div>
  </nav>

  <div class="container-fluid text-center">
    <div class="row content">
        <div class="col-sm-2 sidenav">
          <h4 id="loggedInUser">You are not logged in...</h4>
        </div>
      <div id="projectData" class="col-sm-8 text-left"></div>
    </div>
  </div>  

  <footer class="container-fluid text-center">
    <h4>Hadron Project Accelerator</h4>
  </footer>  

  </body>
 </html>
